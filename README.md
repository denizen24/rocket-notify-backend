## –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

`rocket-notify-backend` ‚Äî —Å–µ—Ä–≤–∏—Å –Ω–∞ NestJS, –∫–æ—Ç–æ—Ä—ã–π –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –æ–ø—Ä–∞—à–∏–≤–∞–µ—Ç Rocket.Chat –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ —Ä–æ—Å—Ç–µ —á–∏—Å–ª–∞ –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –≤ Telegram‚Äë–∫–∞–Ω–∞–ª/–±–æ—Ç. –ü—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è —Ñ–æ–Ω–æ–≤–æ–≥–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞, –±–µ–∑ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ UI. –°–æ–∑–¥–∞–Ω –≤ –≤–∏–¥—É —Ç–æ–≥–æ —á—Ç–æ –≤ –±–µ—Å–ø–ª–∞—Ç–Ω–æ–π –≤–µ—Ä—Å–∏–∏ Rocket.Chat –µ—Å—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º –∏ –º–æ–±–∏–ª—å–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç—ã –Ω–µ –ø–æ–ª—É—á–∞—é—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –∏–∑ —á–∞—Ç–æ–≤.

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ‚Üí Telegram Bot (/start, /login) ‚Üí NestJS ‚Üí –ë–î (Prisma 7/SQLite) ‚Üí Polling per user ‚Üí –õ–∏—á–Ω—ã–π Telegram —á–∞—Ç
```

## –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞

### –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞—Ö–æ–¥–∏—Ç –±–æ—Ç–∞ –≤ Telegram –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç `/start`
2. –ë–æ—Ç —Å–æ–∑–¥–∞—ë—Ç –∑–∞–ø–∏—Å—å –≤ –ë–î (–µ—Å–ª–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç)
3. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç `/login <server> <user> <pass>`
4. –°–µ—Ä–≤–∏—Å –∞–≤—Ç–æ—Ä–∏–∑—É–µ—Ç—Å—è –≤ Rocket.Chat –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ç–æ–∫–µ–Ω—ã –≤ –ë–î

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
1. `RocketChatPollingService` –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –≤—Å–µ—Ö –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ –ë–î
2. –î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
   - –ü–æ–ª—É—á–∞–µ—Ç –ø–æ–¥–ø–∏—Å–∫–∏ —á–µ—Ä–µ–∑ `GET /api/v1/subscriptions.get`
   - –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ—Ç –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–µ (–∫–∞–Ω–∞–ª—ã, –ª–∏—á–Ω—ã–µ, –≥—Ä—É–ø–ø—ã)
   - –ï—Å–ª–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–≤–µ–ª–∏—á–∏–ª–æ—Å—å ‚Äî –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ –ª–∏—á–Ω—ã–π Telegram —á–∞—Ç
   - –û–±–Ω–æ–≤–ª—è–µ—Ç `lastUnread` –≤ –ë–î

## –ú–æ–¥—É–ª–∏ –∏ —Å–µ—Ä–≤–∏—Å—ã

### Core –º–æ–¥—É–ª–∏
- **`AppModule`** ‚Äî –∫–æ—Ä–Ω–µ–≤–æ–π –º–æ–¥—É–ª—å, –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –≤—Å–µ –º–æ–¥—É–ª–∏
- **`PrismaModule`** ‚Äî –≥–ª–æ–±–∞–ª—å–Ω—ã–π –º–æ–¥—É–ª—å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ë–î (SQLite —á–µ—Ä–µ–∑ Prisma 7)
  - –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç `ConfigModule` –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ `ConfigService`
  - –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç `PrismaService` –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤–æ –≤—Å–µ—Ö –º–æ–¥—É–ª—è—Ö
- **`ConfigModule`** ‚Äî –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è (–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –≤ `AppModule`)

### Telegram
- **`BotModule`** ‚Äî –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ Telegraf –±–æ—Ç–∞ —Å —Å–µ—Å—Å–∏—è–º–∏
  - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `TelegrafModule.forRootAsync` —Å `ConfigService`
  - –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç `ConfigModule` –≤ –æ–ø—Ü–∏—è—Ö `forRootAsync`
- **`TelegramModule`** ‚Äî –æ—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π —á–µ—Ä–µ–∑ Telegram Bot API
  - –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç `ConfigModule` –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ `ConfigService`
  - –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç `TelegramService`
- **`TelegramService`** ‚Äî –º–µ—Ç–æ–¥—ã –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π:
  - `sendToUser(chatId, text)` ‚Äî –æ—Ç–ø—Ä–∞–≤–∫–∞ –≤ –ª–∏—á–Ω—ã–π —á–∞—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  - `sendUnreadAlert(chatId, unreadCount, mentions?)` ‚Äî —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö

### Rocket.Chat
- **`RocketChatModule`** ‚Äî –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å Rocket.Chat API
  - –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç `TelegramModule`, `PrismaModule`, `UserModule` (—á–µ—Ä–µ–∑ `forwardRef`)
  - –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç `RocketChatService`
- **`RocketChatService`** ‚Äî –º–µ—Ç–æ–¥—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Rocket.Chat:
  - `login(server, user, password)` ‚Äî –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `LoginResult` —Å —Ç–æ–∫–µ–Ω–∞–º–∏
  - `getSubscriptions(server, token, userId, instanceId?)` ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–æ–∫
  - `getUnreadCount(server, token, userId, instanceId?)` ‚Äî –ø–æ–¥—Å—á—ë—Ç –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö
- **`RocketChatPollingService`** ‚Äî –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–π –æ–ø—Ä–æ—Å –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç)
  - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `forwardRef` –¥–ª—è –∏–Ω–∂–µ–∫—Ü–∏–∏ `UserService` (–∏–∑–±–µ–≥–∞–µ—Ç —Ü–∏–∫–ª–∏—á–µ—Å–∫–æ–π –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏)

### User management
- **`UserModule`** ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
  - –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç `PrismaModule`, `RocketChatModule` (—á–µ—Ä–µ–∑ `forwardRef`)
  - –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç `UserService`
- **`UserController`** ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥ Telegram –±–æ—Ç–∞:
  - `/start` ‚Äî –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏
  - `/login <server> <user> <pass>` ‚Äî —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∫—Ä–µ–¥–æ–≤ Rocket.Chat
  - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã `@Update()`, `@Command()`, `@Action()` –∏–∑ `nestjs-telegraf`
- **`UserService`** ‚Äî —Ä–∞–±–æ—Ç–∞ —Å –ë–î:
  - `findOrCreateTelegramUser(telegramId)` ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ/–ø–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  - `updateRocketChatCreds(telegramId, server, user, pass)` ‚Äî —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤ Rocket.Chat
  - `getAllEnabledUsers()` ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
  - `updateLastUnread(userId, lastUnread)` ‚Äî –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—á—ë—Ç—á–∏–∫–∞ –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö
  - `toggleEnabled(telegramId, enabled)` ‚Äî –≤–∫–ª—é—á–µ–Ω–∏–µ/–≤—ã–∫–ª—é—á–µ–Ω–∏–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
  - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `forwardRef` –¥–ª—è –∏–Ω–∂–µ–∫—Ü–∏–∏ `RocketChatService` (–∏–∑–±–µ–≥–∞–µ—Ç —Ü–∏–∫–ª–∏—á–µ—Å–∫–æ–π –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏)

### –í–µ–±-–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã
- **`AppController`** ‚Äî REST API –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
  - `GET /users` ‚Äî —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (—Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç)
  - `POST /users/:telegramId/enable` ‚Äî –≤–∫–ª—é—á–µ–Ω–∏–µ/–≤—ã–∫–ª—é—á–µ–Ω–∏–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

## –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (Prisma 7 + SQLite)

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Prisma 7
- **`prisma.config.ts`** ‚Äî –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Prisma (URL –ë–î, –º–∏–≥—Ä–∞—Ü–∏–∏)
- **`prisma/schema.prisma`** ‚Äî —Å—Ö–µ–º–∞ –ë–î (–±–µ–∑ `url` –≤ datasource, —Ç–æ–ª—å–∫–æ `provider`)

### –ú–æ–¥–µ–ª—å User
```prisma
model User {
  id          String   @id @default(cuid())
  telegramId  String   @unique
  rcServer    String?
  rcUser      String?
  rcToken     String?
  rcUserId    String?
  rcInstanceId String?
  intervalMin Int      @default(5)
  enabled     Boolean  @default(true)
  lastUnread  Int      @default(0)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}
```

### PrismaService
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `@prisma/adapter-better-sqlite3` –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å SQLite –≤ Prisma 7
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ñ–æ—Ä–º–∞—Ç `DATABASE_URL` (–¥–æ–ª–∂–µ–Ω –Ω–∞—á–∏–Ω–∞—Ç—å—Å—è —Å `file:`)
- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç `process.env.DATABASE_URL` –ø–µ—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º PrismaClient
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –∞–¥–∞–ø—Ç–µ—Ä `PrismaBetterSqlite3` –≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–µ

### –ú–∏–≥—Ä–∞—Ü–∏–∏
- `npx prisma migrate dev --name <name>` ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π
- `npx prisma generate` ‚Äî –≥–µ–Ω–µ—Ä–∞—Ü–∏—è Prisma Client

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (env)

–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:

- `TELEGRAM_BOT_TOKEN` ‚Äî —Ç–æ–∫–µ–Ω Telegram –±–æ—Ç–∞
- `DATABASE_URL` ‚Äî URL –ë–î (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `file:./dev.db` –¥–ª—è SQLite, –¥–æ–ª–∂–µ–Ω –Ω–∞—á–∏–Ω–∞—Ç—å—Å—è —Å `file:`)

–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ:
- `PORT` ‚Äî –ø–æ—Ä—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 3000)

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –ö—Ä–µ–¥—ã Rocket.Chat —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –ë–î –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ—Ç–¥–µ–ª—å–Ω–æ.

## –¢–∏–ø–∏–∑–∞—Ü–∏—è

### –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã
- **`User`** (`src/user/user.types.ts`) ‚Äî –º–æ–¥–µ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ –ë–î
- **`UnreadCount`** ‚Äî —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π (`total`, `channels`, `im`, `groups`)
- **`LoginResult`** ‚Äî —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –≤ Rocket.Chat (`authToken`, `userId`, `instanceId?`)
- **`Subscription`** ‚Äî –º–æ–¥–µ–ª—å –ø–æ–¥–ø–∏—Å–∫–∏ Rocket.Chat (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ `RocketChatService`)

### –¢–∏–ø–∏–∑–∞—Ü–∏—è —Å–µ—Ä–≤–∏—Å–æ–≤
- –í—Å–µ –º–µ—Ç–æ–¥—ã —Å–µ—Ä–≤–∏—Å–æ–≤ –∏–º–µ—é—Ç —è–≤–Ω—ã–µ —Ç–∏–ø—ã –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `as Promise<User>` –¥–ª—è –ø—Ä–∏–≤–µ–¥–µ–Ω–∏—è —Ç–∏–ø–æ–≤ Prisma Client
- –í `AppController` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å `UserResponse` –¥–ª—è —Ç–∏–ø–∏–∑–∞—Ü–∏–∏ –æ—Ç–≤–µ—Ç–æ–≤

## –¶–∏–∫–ª–∏—á–µ—Å–∫–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `forwardRef()` –¥–ª—è —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:

- **`UserModule` ‚Üî `RocketChatModule`** ‚Äî –æ–±–∞ –º–æ–¥—É–ª—è –∏—Å–ø–æ–ª—å–∑—É—é—Ç `forwardRef` –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ
- **`UserService` ‚Üî `RocketChatService`** ‚Äî `UserService` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `@Inject(forwardRef(() => RocketChatService))`
- **`RocketChatPollingService` ‚Üî `UserService`** ‚Äî `RocketChatPollingService` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `@Inject(forwardRef(() => UserService))`

## –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **NestJS 11** ‚Äî —Ñ—Ä–µ–π–º–≤–æ—Ä–∫
- **Prisma 7** ‚Äî ORM –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ë–î
- **@prisma/adapter-better-sqlite3** ‚Äî –∞–¥–∞–ø—Ç–µ—Ä –¥–ª—è SQLite –≤ Prisma 7
- **better-sqlite3** ‚Äî –¥—Ä–∞–π–≤–µ—Ä SQLite
- **SQLite** ‚Äî –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- **nestjs-telegraf** ‚Äî –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Telegram Bot API
- **Axios** ‚Äî HTTP –∫–ª–∏–µ–Ω—Ç –¥–ª—è Rocket.Chat API
- **TypeScript** ‚Äî —è–∑—ã–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è

## –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–í—Å–µ —Å–µ—Ä–≤–∏—Å—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π `Logger` –∏–∑ NestJS:

- **`RocketChatService`** ‚Äî –ª–æ–≥–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∏ –æ—à–∏–±–æ–∫
- **`RocketChatPollingService`** ‚Äî –ª–æ–≥–∏ –∑–∞–ø—É—Å–∫–∞ polling, –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- **`UserService`** ‚Äî –ª–æ–≥–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫—Ä–µ–¥–æ–≤ –∏ –æ—à–∏–±–æ–∫
- **`TelegramService`** ‚Äî –ª–æ–≥–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –∏ –æ—à–∏–±–æ–∫

–§–æ—Ä–º–∞—Ç –ª–æ–≥–æ–≤: `[üöÄ Polling started]`, `[‚úÖ –ê–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω –≤ Rocket.Chat: ...]`, `[üìä Unread: total=...]`, `[üì± Sent alert: ...]`

## –ó–∞–ø—É—Å–∫

### –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞
```bash
npm run start:dev
```

### Production
```bash
npm run build
npm run start:prod
```

### –ú–∏–≥—Ä–∞—Ü–∏–∏ –ë–î
```bash
npx prisma migrate dev --name init
npx prisma generate
```

### –õ–∏–Ω—Ç–µ—Ä
```bash
npm run lint
```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
1. –ù–∞–π—Ç–∏ –±–æ—Ç–∞ –≤ Telegram: `@RocketNotifyBot`
2. –û—Ç–ø—Ä–∞–≤–∏—Ç—å `/start`
3. –û—Ç–ø—Ä–∞–≤–∏—Ç—å `/login <server> <user> <pass>`
   - –ü—Ä–∏–º–µ—Ä: `/login https://rocketchat.medcontrol.cloud john pass123`
4. –ü–æ–ª—É—á–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ –ª–∏—á–Ω—ã–π —á–∞—Ç –ø—Ä–∏ –ø–æ—è–≤–ª–µ–Ω–∏–∏ –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π

### –î–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
- `GET /users` ‚Äî –ø—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- `POST /users/:telegramId/enable` ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

## –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –ò–Ω—Ç–µ—Ä–≤–∞–ª polling —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π: 5 –º–∏–Ω—É—Ç (–º–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —á–µ—Ä–µ–∑ `intervalMin` –≤ –ë–î –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)
- –¢–æ–∫–µ–Ω—ã Rocket.Chat —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –ë–î –∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ—Ç–¥–µ–ª—å–Ω–æ
- `X-Instance-Id` –ø–æ–ª—É—á–∞–µ—Ç—Å—è –ø—Ä–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –ë–î
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —É–≤–µ–ª–∏—á–µ–Ω–∏–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö (—Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å `lastUnread`)
- –í `TelegramModule` –∏ `PrismaModule` –ø–æ–¥–∫–ª—é—á—ë–Ω `ConfigModule` –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ `ConfigService`
- `PrismaModule` —è–≤–ª—è–µ—Ç—Å—è –≥–ª–æ–±–∞–ª—å–Ω—ã–º –º–æ–¥—É–ª–µ–º –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∏–∑ –ª—é–±–æ–≥–æ –º–µ—Å—Ç–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- `BotModule` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `ConfigModule` –≤ –æ–ø—Ü–∏—è—Ö `forRootAsync` –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ `ConfigService`
- Prisma 7 —Ç—Ä–µ–±—É–µ—Ç –∞–¥–∞–ø—Ç–µ—Ä –¥–ª—è SQLite ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `@prisma/adapter-better-sqlite3`
- `DATABASE_URL` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –∏ –ø—Ä–∏–≤–æ–¥–∏—Ç—Å—è –∫ —Ñ–æ—Ä–º–∞—Ç—É `file:./dev.db`, –µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω –¥—Ä—É–≥–æ–π —Ñ–æ—Ä–º–∞—Ç